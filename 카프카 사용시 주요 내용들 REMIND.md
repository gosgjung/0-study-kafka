# 카프카 사용시 주요 내용들 REMIND

이전 문서가 지저분하기도 하고, 제목도 급하게 지어서 뭔가 어수선하고 정리가 안되서 새로 만들었다.



- 카프카/RabbitMQ 클러스터링만 걸었다고 작업부하까지 클러스터링에 맡기면 안된다.
- 카프카/RabbitMQ 를 작업큐/작업토픽으로 사용하지 말자. (양심적으로 ^^;;)
  - 현업에서 RabbitMQ를 블로킹 작업들을 수행하는 작업큐로 쓰려는 사람을 본적이 있었다.
  - 개인적인 의견은 가급적이면 이벤트만 발급해서 전달하는게 맞지 않나 싶다.
- 데이터를 즉시 순서대로 처리하게끔 하는 구조보다는, 고유 킷값으로 순서를 파악할수 있게 하자.
- 이벤트 발생 속도에 비해 물리적인 작업 처리 속도/처리량이 못 따라갈 경우
  - 인메모리 캐시로 작업을 위한 자료구조를 만들고, 생산자/소비자 로직을 따로 만들어야 한다.
- 레디스 외에도 로컬 인메모리 캐시 마련하자 (록스DB, 인메모리 DB 등등)
  - 머신 안에서 돌아가는 자바 네이티브 메모리를 사용하는 인메모리 자료구조를 사용하면 좋다.
  - 물론 레디스도 좋지만, 그냥... 상용에 서비스들이 사용하는 레디스를 오염시키고 싶지 않을때도 있다.
  - 네트워크 IO 보다는 지역적으로 로컬 인메모리 자료구조 쓰면 이점이 있다.
  - 복구는 브로커의 토픽에 오프셋이 멈춘 시점부터 복구하면 되기에 작업 큐는 휘발성 자료구조를 써도 무방하다.
  - 이벤트를 기반으로 작업큐를 다시 돌리면 되기 때문이다.



위의 내용 외에도 운영적인 면들도 계속 공부해서 업데이트 할 예정!!! 